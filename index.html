<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Morse TX/RX – High Throughput</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        line-height: 1.45;
      }
      body {
        max-width: 900px;
        margin: 2rem auto;
        padding: 0 1rem;
      }
      h1 {
        font-size: 1.5rem;
        margin: 0 0 0.5rem;
      }
      section {
        border: 1px solid #e5e5e5;
        border-radius: 10px;
        padding: 1rem;
        margin: 1rem 0;
      }
      label {
        display: block;
        margin: 0.5rem 0 0.25rem;
        font-weight: 600;
      }
      textarea {
        width: 100%;
        min-height: 5rem;
      }
      .row {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      }
      .small {
        font-size: 0.9rem;
        color: #555;
      }
      button {
        padding: 0.5rem 0.8rem;
      }
      input[type="range"] {
        width: 200px;
        vertical-align: middle;
      }
      .kv {
        display: grid;
        grid-template-columns: 160px 1fr;
        gap: 0.25rem 0.75rem;
      }
      .pill {
        display: inline-block;
        padding: 0.12rem 0.5rem;
        border: 1px solid #ddd;
        border-radius: 999px;
        font-size: 0.85rem;
      }
      .status {
        min-height: 1.2em;
      }
    </style>
  </head>
  <body>
    <h1>Morse Code – Transmit / Receive (Throughput-Optimized)</h1>
    <p class="small">
      Defaults: 650 Hz, 28 WPM. Use HTTPS or
      <span class="mono">localhost</span> for microphone access.
    </p>

    <section id="tx">
      <h2>Transmit</h2>
      <div class="row">
        <label>Text</label>
      </div>
      <textarea
        id="txInput"
        placeholder="Type text to send… e.g., CQ CQ DE TEST K"
      ></textarea>
      <div class="row" style="margin-top: 0.5rem">
        <button id="sendBtn">Send</button>
        <button
          id="sendVVVBtn"
          title="Send short preamble to help RX lock speed/frequency"
        >
          Send “VVV”
        </button>
        <span class="small status" id="txStatus"></span>
      </div>
      <div class="kv small" style="margin-top: 0.5rem">
        <div>WPM (speed)</div>
        <div>
          <input type="range" id="wpm" min="10" max="45" step="1" value="28" />
          <span class="mono" id="wpmVal">28</span>
        </div>
        <div>Tone (Hz)</div>
        <div>
          <input
            type="range"
            id="tone"
            min="450"
            max="900"
            step="1"
            value="650"
          />
          <span class="mono" id="toneVal">650</span>
        </div>
        <div>Volume</div>
        <div>
          <input
            type="range"
            id="vol"
            min="0"
            max="1"
            step="0.01"
            value="0.85"
          />
          <span class="mono" id="volVal">0.85</span>
        </div>
      </div>
    </section>

    <section id="rx">
      <h2>Receive</h2>
      <div class="row">
        <button id="listenBtn">Listen</button>
        <button id="stopBtn" disabled>Stop</button>
        <button id="clearBtn">Clear</button>
        <label class="pill"
          ><input type="checkbox" id="trackFreq" /> Track
          frequency</label
        >
      </div>
      <label for="rxOutput" style="margin-top: 0.5rem">Decoded output</label>
      <textarea
        id="rxOutput"
        placeholder="Decoded text will appear here…"
        readonly
      ></textarea>
      <div class="kv small" style="margin-top: 0.5rem">
        <div>Estimated WPM</div>
        <div class="mono" id="estWpm">–</div>
        <div>Unit (ms)</div>
        <div class="mono" id="unitMs">–</div>
        <div>Center F0 (Hz)</div>
        <div class="mono" id="f0">–</div>
        <div>SNR (approx)</div>
        <div class="mono" id="snr">–</div>
        <div>Status</div>
        <div class="mono" id="rxStatus">Idle</div>
      </div>
    </section>

    <section>
      <h2>Cheat Sheet (subset)</h2>
      <pre class="mono" style="white-space: pre-wrap; margin: 0">
A .-   B -...   C -.-.   D -..   E .   F ..-.   G --.   H ....   I ..
J .--- K -.-    L .-..   M --    N -.  O ---    P .--.  Q --.-   R .-.
S ...  T -      U ..-    V ...-  W .-- X -..-   Y -.--  Z --..
0 ----- 1 .---- 2 ..--- 3 ...-- 4 ....- 5 ..... 6 -.... 7 --... 8 ---.. 9 ----.
  </pre
      >
    </section>

    <script type="module" src="main.js"></script>
  </body>
</html>
